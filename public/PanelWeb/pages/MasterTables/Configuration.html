<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Configuración básica del documento -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Configuración de caché para prevenir almacenamiento de datos sensibles -->
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../../assets/Recourse/Logo/1.png">
    <link rel="shortcut icon" href="../../assets/Recourse/Logo/1.png">
    
    <title>Panel de Administración - Configuración</title>
    
    <!-- Tabler CSS Framework -->
    <link rel="stylesheet" href="../../assets/tabler/css/tabler.min.css">
    <link rel="stylesheet" href="../../assets/tabler/css/tabler-vendors.min.css">
    
    <!-- Global toast styles -->
    <link rel="stylesheet" href="../../assets/css/global-toast.css">
    
    <!-- Component specific styles -->
    <link rel="stylesheet" href="../../assets/css/sidebar.css">
    <link rel="stylesheet" href="../../assets/css/topbar.css">
    <link rel="stylesheet" href="../../assets/css/profile.css">
    
    <!-- Configuration specific styles -->
    <link rel="stylesheet" href="../../assets/css/mastertables/Configuration.css">
    
    <!-- Font Awesome para iconografía -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Configuración de la página -->
    <script>
        window.pageConfig = {
            activeSection: 'tablas', // Sección activa en el sidebar
            pageTitle: {
                icon: 'fas fa-cogs',
                text: 'Gestión de Configuración'
            }
        };
    </script>
</head>
<body>
    <!-- Layout principal usando estructura Tabler -->
    <div class="page">
        <!-- Contenedor del sidebar - se carga dinámicamente -->
        <div id="sidebar-container"></div>

        <!-- Contenido principal usando estructura Tabler -->
        <div class="page-wrapper">
            <!-- Contenedor del topbar - se carga dinámicamente -->
            <div id="topbar-container"></div>
            
            <!-- Page content area -->
            <div class="page-body">
                <div class="container-xl">
                    <!-- Header de la página -->
                    <div class="page-header d-print-none">
                        <div class="container-xl">
                            <div class="row g-2 align-items-center">
                                <div class="col">
                                    <div class="page-pretitle">
                                        Gestión de Datos
                                    </div>
                                    <h2 class="page-title">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z"></path>
                                            <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path>
                                        </svg>
                                        Configuración del Sistema
                                    </h2>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contenido principal -->
                    <div class="page-body">
                        <div class="container-xl">
                            
                            <!-- Page Header con estructura Tabler -->
                            <div id="config-content">
                                <div class="row g-2 align-items-center">
                                    <div class="col">
                                    </div>
                                    <!-- Page title actions -->
                                    <div class="col-auto ms-auto d-print-none">
                                        <div class="btn-list">
                                            <button class="btn btn-outline-cyan" id="refresh-btn" title="Actualizar datos">
                                                <i class="fas fa-sync-alt me-2"></i>
                                                Actualizar
                                            </button>
                                            <button class="btn btn-indigo" id="btn-create-config">
                                                <i class="fas fa-plus me-2"></i>
                                                Nueva Configuración
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filters Card -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-filter me-2"></i>
                                        Filtros de búsqueda
                                    </h3>
                                    <div class="card-actions">
                                        <button class="btn btn-sm btn-outline-orange" id="clear-filters-btn">
                                            <i class="fas fa-times me-1"></i>
                                            Limpiar
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-md-4">
                                            <label class="form-label">Búsqueda general</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="search-input" 
                                                       placeholder="Buscar por clave o valor...">
                                                <button class="btn btn-teal" type="button" id="search-btn">
                                                    <i class="fas fa-search"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Estado</label>
                                            <select class="form-select" id="filter-active">
                                                <option value="">Todos</option>
                                                <option value="true">Activo</option>
                                                <option value="false">Inactivo</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Clave específica</label>
                                            <input type="text" class="form-control" id="filter-key" 
                                                   placeholder="Ej: app.maintenance_mode">
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Ordenar por</label>
                                            <div class="row g-2">
                                                <div class="col-8">
                                                    <select class="form-select" id="filter-sort-by">
                                                        <option value="key">Clave</option>
                                                        <option value="id">ID</option>
                                                        <option value="value">Valor</option>
                                                        <option value="active">Estado</option>
                                                    </select>
                                                </div>
                                                <div class="col-4">
                                                    <select class="form-select" id="filter-sort-direction">
                                                        <option value="asc">ASC</option>
                                                        <option value="desc">DESC</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Configurations Table Card -->
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-list me-2"></i>
                                        Lista de Configuraciones
                                    </h3>
                                    <div class="card-actions">
                                        <div class="dropdown">
                                            <button class="btn btn-sm btn-outline-pink dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                                <i class="fas fa-download me-1"></i>
                                                Exportar
                                            </button>
                                            <div class="dropdown-menu">
                                                <a class="dropdown-item" href="#" id="export-excel-btn">
                                                    <i class="fas fa-file-excel me-2"></i>
                                                    Excel
                                                </a>
                                                <a class="dropdown-item" href="#" id="export-pdf-btn">
                                                    <i class="fas fa-file-pdf me-2"></i>
                                                    PDF
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-vcenter">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Clave</th>
                                                <th>Valor</th>
                                                <th>Estado</th>
                                                <th>Fecha Registro</th>
                                                <th class="w-1">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="configurations-table-body">
                                            <!-- Dynamic content will be inserted here -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="card-footer d-flex align-items-center">
                                    <p class="m-0 text-muted">
                                        Mostrando <span id="showing-start">0</span> a <span id="showing-end">0</span> 
                                        de <span id="total-records">0</span> registros
                                    </p>
                                    <ul class="pagination m-0 ms-auto">
                                        <li class="page-item">
                                            <button class="page-link" id="prev-page-btn" disabled>
                                                <i class="fas fa-chevron-left"></i>
                                                Anterior
                                            </button>
                                        </li>
                                        <li class="page-item active">
                                            <span class="page-link" id="current-page-info">1</span>
                                        </li>
                                        <li class="page-item">
                                            <button class="page-link" id="next-page-btn">
                                                Siguiente
                                                <i class="fas fa-chevron-right"></i>
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenedor del modal - se carga dinámicamente -->
    <div id="modal-container"></div>

    <!-- Carga de scripts en orden específico para manejar dependencias -->
    <!-- 1. Component Loader (debe ir primero) -->
    <script src="../../assets/js/ui/component-loader.js"></script>
    
    <!-- 2. Utilidades y herramientas base -->
    <script src="../../assets/js/global-initializer.js"></script>
    <script src="../../assets/js/ui/global-toast.js"></script>
    <script src="../../assets/js/auth/permissions.js"></script>
    <script src="../../assets/js/auth/auth-checker.js"></script>
    <script src="../../assets/js/auth/route-guard.js"></script>
    
    <script>
        // Inicializa RouteGuard para proteger la página
        window.routeGuard = new RouteGuard("../../index.html");
    </script>
    
    <!-- 2. Servicios de API básicos -->
    <script src="../../assets/js/api/services/profile-service.js"></script>
    <script src="../../assets/js/api/services/MasterTables/Configuration/configuration-service.js"></script>
    <script src="../../assets/js/api/services/MasterTables/Configuration/create-configuration-service.js"></script>

    <!-- 3. Controladores de UI -->
    <script src="../../assets/js/ui/controllers/Components/sidebar-controller.js"></script>
    <script src="../../assets/js/ui/controllers/Components/topbar-controller.js"></script>
    <script src="../../assets/js/ui/controllers/Components/profile-controller.js"></script>
    <script src="../../assets/js/ui/controllers/MasterTables/Configuration/create-configuration-modal-controller.js"></script>
    <script src="../../assets/js/ui/controllers/MasterTables/Configuration/configuration-controller.js"></script>

    <!-- 4. Inicializador específico de la página -->
    <script src="../../assets/js/ui/initializers/MasterTables/configuration-initializer.js"></script>

    <!-- 5. Scripts de Tabler para funcionalidad completa -->
    <script src="../../assets/tabler/js/tabler.min.js"></script>

    <!-- Toast notification for profile operations -->
    <div id="recovery-toast" class="recovery-toast">
        <div class="recovery-toast-content">
            <i class="fas fa-check-circle"></i>
            <span id="recovery-toast-message">Operación completada correctamente</span>
        </div>
    </div>
</body>
</html>
