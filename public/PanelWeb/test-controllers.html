<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Controladores de Reportes</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>Prueba de Controladores de Reportes de Auditoría</h1>
    
    <div class="test-section">
        <h3>1. Verificar Scripts Cargados</h3>
        <div id="scripts-test"></div>
    </div>
    
    <div class="test-section">
        <h3>2. Verificar Controladores Disponibles</h3>
        <div id="controllers-test"></div>
    </div>
    
    <div class="test-section">
        <h3>3. Verificar Servicios Disponibles</h3>
        <div id="services-test"></div>
    </div>

    <!-- Scripts de Reportes -->
    <script src="../assets/js/auth/auth-checker.js"></script>
    <script src="../assets/js/ui/global-toast.js"></script>
    <script src="../assets/js/ui/controllers/sidebar-controller.js"></script>
    <script src="../assets/js/ui/controllers/topbar-controller.js"></script>
    <script src="../assets/js/ui/controllers/profile-controller.js"></script>
    
    <!-- Servicios -->
    <script src="../assets/js/api/services/Audit/incident-reports-service.js"></script>
    <script src="../assets/js/api/services/Audit/vehicle-reports-service.js"></script>
    <script src="../assets/js/api/services/Audit/infraction-reports-service.js"></script>
    <script src="../assets/js/api/services/Audit/travel-reports-service.js"></script>
    
    <!-- Controladores de reportes -->
    <script src="../assets/js/ui/controllers/Audit/base-reports-controller.js"></script>
    <script src="../assets/js/ui/controllers/Audit/incident-reports-controller.js"></script>
    <script src="../assets/js/ui/controllers/Audit/vehicle-reports-controller.js"></script>
    <script src="../assets/js/ui/controllers/Audit/infraction-reports-controller.js"></script>
    <script src="../assets/js/ui/controllers/Audit/travel-reports-controller.js"></script>
    <script src="../assets/js/ui/controllers/Audit/audit-reports-main-controller.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const scriptsDiv = document.getElementById('scripts-test');
            const controllersDiv = document.getElementById('controllers-test');
            const servicesDiv = document.getElementById('services-test');
            
            // Test scripts
            const requiredClasses = [
                'BaseReportsController',
                'IncidentReportsController', 
                'VehicleReportsController',
                'InfractionReportsController',
                'TravelReportsController',
                'AuditReportsMainController'
            ];
            
            let scriptsHtml = '';
            requiredClasses.forEach(className => {
                if (window[className]) {
                    scriptsHtml += `<div class="success">✅ ${className} cargado</div>`;
                } else {
                    scriptsHtml += `<div class="error">❌ ${className} NO cargado</div>`;
                }
            });
            scriptsDiv.innerHTML = scriptsHtml;
            
            // Test controllers instantiation
            let controllersHtml = '';
            try {
                const mainController = new window.AuditReportsMainController();
                controllersHtml += '<div class="success">✅ AuditReportsMainController instanciado correctamente</div>';
                controllersHtml += `<div class="success">✅ Controladores específicos: ${Object.keys(mainController.controllers).join(', ')}</div>`;
            } catch (error) {
                controllersHtml += `<div class="error">❌ Error al instanciar: ${error.message}</div>`;
            }
            controllersDiv.innerHTML = controllersHtml;
            
            // Test services
            const requiredServices = [
                'IncidentReportsService',
                'VehicleReportsService', 
                'InfractionReportsService',
                'TravelReportsService'
            ];
            
            let servicesHtml = '';
            requiredServices.forEach(serviceName => {
                if (window[serviceName]) {
                    servicesHtml += `<div class="success">✅ ${serviceName} disponible</div>`;
                    try {
                        const service = new window[serviceName]();
                        servicesHtml += `<div class="success">  └─ Instanciación exitosa</div>`;
                    } catch (error) {
                        servicesHtml += `<div class="warning">  └─ Error al instanciar: ${error.message}</div>`;
                    }
                } else {
                    servicesHtml += `<div class="error">❌ ${serviceName} NO disponible</div>`;
                }
            });
            servicesDiv.innerHTML = servicesHtml;
        });
    </script>
</body>
</html>
